{
  if (host == null) {
    return null;
  }
  SSLSession session;
  HostAndPort hostAndPortKey=new HostAndPort(host,port);
synchronized (sessionsByHostAndPort) {
    session=sessionsByHostAndPort.get(hostAndPortKey);
  }
  if (session != null && session.isValid()) {
    return session;
  }
  if (persistentCache != null) {
    byte[] data=persistentCache.getSessionData(host,port);
    if (data != null) {
      session=toSession(data,host,port);
      if (session != null && session.isValid()) {
        super.putSession(session);
synchronized (sessionsByHostAndPort) {
          sessionsByHostAndPort.put(hostAndPortKey,session);
        }
        return session;
      }
    }
  }
  return null;
}
