{
  int subCount=subString.count;
  if (subCount <= count && start >= 0) {
    if (subCount > 0) {
      if (start > count - subCount) {
        start=count - subCount;
      }
      char[] target=subString.value;
      int subOffset=subString.offset;
      char firstChar=target[subOffset];
      int end=subOffset + subCount;
      while (true) {
        int i=lastIndexOf(firstChar,start);
        if (i == -1) {
          return -1;
        }
        int o1=offset + i, o2=subOffset;
        while (++o2 < end && value[++o1] == target[o2]) {
        }
        if (o2 == end) {
          return i;
        }
        start=i - 1;
      }
    }
    return start < count ? start : count;
  }
  return -1;
}
