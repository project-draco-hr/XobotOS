{
  x=(x + 1) & 0xff;
  y=(engineState[x] + y) & 0xff;
  byte tmp=engineState[x];
  engineState[x]=engineState[y];
  engineState[y]=tmp;
  return (byte)(in ^ engineState[(engineState[x] + engineState[y]) & 0xff]);
}
