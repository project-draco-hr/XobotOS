{
  ObjectStreamClass classDesc=readClassDesc();
  if (classDesc == null) {
    throw missingClassDescriptor();
  }
  int newHandle=nextHandle();
  Class<?> objectClass=classDesc.forClass();
  Object result=null;
  Object registeredResult=null;
  if (objectClass != null) {
    result=classDesc.newInstance(objectClass);
    registerObjectRead(result,newHandle,unshared);
    registeredResult=result;
  }
 else {
    result=null;
  }
  try {
    currentObject=result;
    currentClass=classDesc;
    boolean wasExternalizable=(classDesc.getFlags() & SC_EXTERNALIZABLE) != 0;
    if (wasExternalizable) {
      boolean blockData=(classDesc.getFlags() & SC_BLOCK_DATA) != 0;
      if (!blockData) {
        primitiveData=input;
      }
      if (mustResolve) {
        Externalizable extern=(Externalizable)result;
        extern.readExternal(this);
      }
      if (blockData) {
        discardData();
      }
 else {
        primitiveData=emptyStream;
      }
    }
 else {
      readHierarchy(result,classDesc);
    }
  }
  finally {
    currentObject=null;
    currentClass=null;
  }
  if (objectClass != null) {
    if (classDesc.hasMethodReadResolve()) {
      Method methodReadResolve=classDesc.getMethodReadResolve();
      try {
        result=methodReadResolve.invoke(result,(Object[])null);
      }
 catch (      IllegalAccessException ignored) {
      }
catch (      InvocationTargetException ite) {
        Throwable target=ite.getTargetException();
        if (target instanceof ObjectStreamException) {
          throw (ObjectStreamException)target;
        }
 else         if (target instanceof Error) {
          throw (Error)target;
        }
 else {
          throw (RuntimeException)target;
        }
      }
    }
  }
  if (result != null && enableResolve) {
    result=resolveObject(result);
  }
  if (registeredResult != result) {
    registerObjectRead(result,newHandle,unshared);
  }
  return result;
}
