{
  int old=ptr;
  Token[] retval=new Token[ntokens];
  for (int i=0; i < ntokens; i++) {
    Token tok=new Token();
    if (startsId()) {
      String id=ttoken();
      tok.tokenValue=id;
      String idUppercase=id.toUpperCase();
      if (currentLexer.containsKey(idUppercase)) {
        Integer type=(Integer)currentLexer.get(idUppercase);
        tok.tokenType=type.intValue();
      }
 else       tok.tokenType=ID;
    }
 else {
      char nextChar=getNextChar();
      tok.tokenValue=String.valueOf(nextChar);
      if (isAlpha(nextChar)) {
        tok.tokenType=ALPHA;
      }
 else       if (isDigit(nextChar)) {
        tok.tokenType=DIGIT;
      }
 else       tok.tokenType=(int)nextChar;
    }
    retval[i]=tok;
  }
  savedPtr=ptr;
  ptr=old;
  return retval;
}
