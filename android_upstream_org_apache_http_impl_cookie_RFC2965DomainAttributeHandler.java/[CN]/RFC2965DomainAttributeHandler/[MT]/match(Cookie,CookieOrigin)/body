{
  if (cookie == null) {
    throw new IllegalArgumentException("Cookie may not be null");
  }
  if (origin == null) {
    throw new IllegalArgumentException("Cookie origin may not be null");
  }
  String host=origin.getHost().toLowerCase(Locale.ENGLISH);
  String cookieDomain=cookie.getDomain();
  if (!domainMatch(host,cookieDomain)) {
    return false;
  }
  String effectiveHostWithoutDomain=host.substring(0,host.length() - cookieDomain.length());
  return effectiveHostWithoutDomain.indexOf('.') == -1;
}
