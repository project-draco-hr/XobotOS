{
  SSLContext sslContext;
  sslContext=SSLContext.getInstance("TLS");
  String algorithm=KeyManagerFactory.getDefaultAlgorithm();
  TrustManagerFactory tmFactory=TrustManagerFactory.getInstance(algorithm);
  KeyManagerFactory kmFactory=KeyManagerFactory.getInstance(algorithm);
  SecureRandom secureRandom=new SecureRandom();
  secureRandom.nextInt();
  KeyStore keyStore=KeyStore.getInstance(keyStoreType);
  KeyStore trustStore=KeyStore.getInstance(keyStoreType);
  keyStore.load(new FileInputStream(keyStoreFile),keyStorePassword);
  trustStore.load(new FileInputStream(trustStoreFile),keyStorePassword);
  tmFactory.init(trustStore);
  kmFactory.init(keyStore,keyStorePassword);
  sslContext.init(kmFactory.getKeyManagers(),tmFactory.getTrustManagers(),secureRandom);
  sslServerSocketFactory=sslContext.getServerSocketFactory();
  sslSocketFactory=sslContext.getSocketFactory();
}
