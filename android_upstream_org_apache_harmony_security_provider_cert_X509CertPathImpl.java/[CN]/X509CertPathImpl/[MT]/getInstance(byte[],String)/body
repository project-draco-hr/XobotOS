{
  if (!encodings.contains(encoding)) {
    throw new CertificateException("Unsupported encoding");
  }
  try {
    if (encodingsArr[0].equals(encoding)) {
      return (X509CertPathImpl)ASN1.decode(in);
    }
 else {
      ContentInfo ci=(ContentInfo)ContentInfo.ASN1.decode(in);
      SignedData sd=ci.getSignedData();
      if (sd == null) {
        throw new CertificateException("Incorrect PKCS7 encoded form: missing signed data");
      }
      List<Certificate> certs=sd.getCertificates();
      if (certs == null) {
        certs=new ArrayList<Certificate>();
      }
      List<X509CertImpl> result=new ArrayList<X509CertImpl>();
      for (      Certificate cert : certs) {
        result.add(new X509CertImpl(cert));
      }
      return new X509CertPathImpl(result,PKCS7,ci.getEncoded());
    }
  }
 catch (  IOException e) {
    throw new CertificateException("Incorrect encoded form: " + e.getMessage());
  }
}
