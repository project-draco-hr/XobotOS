{
  int resultLen=0;
  if (bufOff == buf.length) {
    resultLen=cipher.processBlock(buf,0,out,outOff);
    System.arraycopy(buf,blockSize,buf,0,blockSize);
    bufOff=blockSize;
  }
  buf[bufOff++]=in;
  return resultLen;
}
