{
  if (out instanceof ASN1OutputStream || out instanceof BEROutputStream) {
    out.writeTag(CONSTRUCTED | TAGGED,tagNo);
    out.write(0x80);
    if (!empty) {
      if (!explicit) {
        Enumeration e;
        if (obj instanceof ASN1OctetString) {
          if (obj instanceof BERConstructedOctetString) {
            e=((BERConstructedOctetString)obj).getObjects();
          }
 else {
            ASN1OctetString octs=(ASN1OctetString)obj;
            BERConstructedOctetString berO=new BERConstructedOctetString(octs.getOctets());
            e=berO.getObjects();
          }
        }
 else         if (obj instanceof ASN1Sequence) {
          e=((ASN1Sequence)obj).getObjects();
        }
 else         if (obj instanceof ASN1Set) {
          e=((ASN1Set)obj).getObjects();
        }
 else {
          throw new RuntimeException("not implemented: " + obj.getClass().getName());
        }
        while (e.hasMoreElements()) {
          out.writeObject(e.nextElement());
        }
      }
 else {
        out.writeObject(obj);
      }
    }
    out.write(0x00);
    out.write(0x00);
  }
 else {
    super.encode(out);
  }
}
