{
  if (namespaceURI == null) {
    return null;
  }
  NodeImpl target=getNamespacingElement();
  for (NodeImpl node=target; node != null; node=node.getContainingElement()) {
    if (namespaceURI.equals(node.getNamespaceURI()) && target.isPrefixMappedToUri(node.getPrefix(),namespaceURI)) {
      return node.getPrefix();
    }
    if (!node.hasAttributes()) {
      continue;
    }
    NamedNodeMap attributes=node.getAttributes();
    for (int i=0, length=attributes.getLength(); i < length; i++) {
      Node attr=attributes.item(i);
      if (!"http://www.w3.org/2000/xmlns/".equals(attr.getNamespaceURI()) || !"xmlns".equals(attr.getPrefix()) || !namespaceURI.equals(attr.getNodeValue())) {
        continue;
      }
      if (target.isPrefixMappedToUri(attr.getLocalName(),namespaceURI)) {
        return attr.getLocalName();
      }
    }
  }
  return null;
}
