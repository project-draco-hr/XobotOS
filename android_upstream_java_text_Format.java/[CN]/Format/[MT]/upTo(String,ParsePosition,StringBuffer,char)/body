{
  int index=position.getIndex(), length=string.length();
  boolean lastQuote=false, quote=false;
  while (index < length) {
    char ch=string.charAt(index++);
    if (ch == '\'') {
      if (lastQuote) {
        buffer.append('\'');
      }
      quote=!quote;
      lastQuote=true;
    }
 else     if (ch == stop && !quote) {
      position.setIndex(index);
      return true;
    }
 else {
      lastQuote=false;
      buffer.append(ch);
    }
  }
  position.setIndex(index);
  return false;
}
