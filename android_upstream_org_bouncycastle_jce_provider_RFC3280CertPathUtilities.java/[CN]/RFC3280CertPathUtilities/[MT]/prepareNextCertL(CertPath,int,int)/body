{
  List certs=certPath.getCertificates();
  X509Certificate cert=(X509Certificate)certs.get(index);
  if (!CertPathValidatorUtilities.isSelfIssued(cert)) {
    if (maxPathLength <= 0) {
      throw new ExtCertPathValidatorException("Max path length not greater than zero",null,certPath,index);
    }
    return maxPathLength - 1;
  }
  return maxPathLength;
}
