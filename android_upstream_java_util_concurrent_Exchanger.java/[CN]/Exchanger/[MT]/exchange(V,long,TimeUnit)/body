{
  if (!Thread.interrupted()) {
    Object v=doExchange((x == null) ? NULL_ITEM : x,true,unit.toNanos(timeout));
    if (v == NULL_ITEM)     return null;
    if (v != CANCEL)     return (V)v;
    if (!Thread.interrupted())     throw new TimeoutException();
  }
  throw new InterruptedException();
}
