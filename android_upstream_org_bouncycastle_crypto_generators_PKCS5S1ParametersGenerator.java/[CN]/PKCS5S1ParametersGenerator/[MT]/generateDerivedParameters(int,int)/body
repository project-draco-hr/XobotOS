{
  keySize=keySize / 8;
  ivSize=ivSize / 8;
  if ((keySize + ivSize) > digest.getDigestSize()) {
    throw new IllegalArgumentException("Can't generate a derived key " + (keySize + ivSize) + " bytes long.");
  }
  byte[] dKey=generateDerivedKey();
  return new ParametersWithIV(new KeyParameter(dKey,0,keySize),dKey,keySize,ivSize);
}
