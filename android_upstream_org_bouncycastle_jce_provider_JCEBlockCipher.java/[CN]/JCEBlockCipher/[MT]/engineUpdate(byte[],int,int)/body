{
  int length=cipher.getUpdateOutputSize(inputLen);
  if (length > 0) {
    byte[] out=new byte[length];
    int len=cipher.processBytes(input,inputOffset,inputLen,out,0);
    if (len == 0) {
      return null;
    }
 else     if (len != out.length) {
      byte[] tmp=new byte[len];
      System.arraycopy(out,0,tmp,0,len);
      return tmp;
    }
    return out;
  }
  cipher.processBytes(input,inputOffset,inputLen,null,0);
  return null;
}
