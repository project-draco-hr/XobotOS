{
  int len=0;
  int outputLen=cipher.getOutputSize(inputLen);
  if (outputLen + outputOffset > output.length) {
    throw new ShortBufferException("need at least " + outputLen + " bytes");
  }
  if (inputLen != 0) {
    len=cipher.processBytes(input,inputOffset,inputLen,output,outputOffset);
  }
  try {
    return (len + cipher.doFinal(output,outputOffset + len));
  }
 catch (  DataLengthException e) {
    throw new IllegalBlockSizeException(e.getMessage());
  }
catch (  InvalidCipherTextException e) {
    throw new BadPaddingException(e.getMessage());
  }
}
