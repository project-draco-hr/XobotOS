{
  if (pos < 0) {
    pos=0;
    bar=0;
    end=BUFF_SIZE - 1;
  }
 else {
    end=(pos + BUFF_SIZE - 1) % BUFF_SIZE;
  }
}
