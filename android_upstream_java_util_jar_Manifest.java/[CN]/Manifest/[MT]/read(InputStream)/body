{
  byte[] buf;
  if (is instanceof ByteArrayInputStream) {
    buf=exposeByteArrayInputStreamBytes((ByteArrayInputStream)is);
  }
 else {
    buf=Streams.readFullyNoClose(is);
  }
  if (buf.length == 0) {
    return;
  }
  byte b=buf[buf.length - 1];
  if (b == 0 || b == 26) {
    buf[buf.length - 1]='\n';
  }
  InitManifest im=new InitManifest(buf,mainAttributes,null);
  mainEnd=im.getPos();
  im.initEntries(entries,chunks);
}
