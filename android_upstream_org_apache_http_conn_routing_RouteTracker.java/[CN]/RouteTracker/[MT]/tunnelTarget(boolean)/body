{
  if (!this.connected) {
    throw new IllegalStateException("No tunnel unless connected.");
  }
  if (this.proxyChain == null) {
    throw new IllegalStateException("No tunnel without proxy.");
  }
  this.tunnelled=TunnelType.TUNNELLED;
  this.secure=secure;
}
