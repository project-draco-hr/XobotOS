{
  engine_was_closed=true;
  engine_was_shutteddown=true;
  isOutboundDone=true;
  isInboundDone=true;
  if (handshake_started) {
    alertProtocol.shutdown();
    alertProtocol=null;
    handshakeProtocol.shutdown();
    handshakeProtocol=null;
    recordProtocol.shutdown();
    recordProtocol=null;
  }
}
