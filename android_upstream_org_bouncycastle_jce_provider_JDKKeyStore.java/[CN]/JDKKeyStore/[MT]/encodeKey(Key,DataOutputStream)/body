{
  byte[] enc=key.getEncoded();
  if (key instanceof PrivateKey) {
    dOut.write(KEY_PRIVATE);
  }
 else   if (key instanceof PublicKey) {
    dOut.write(KEY_PUBLIC);
  }
 else {
    dOut.write(KEY_SECRET);
  }
  dOut.writeUTF(key.getFormat());
  dOut.writeUTF(key.getAlgorithm());
  dOut.writeInt(enc.length);
  dOut.write(enc);
}
