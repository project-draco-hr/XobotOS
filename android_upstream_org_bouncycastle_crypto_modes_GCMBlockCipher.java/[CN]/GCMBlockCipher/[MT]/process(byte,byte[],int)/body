{
  bufBlock[bufOff++]=in;
  if (bufOff == bufBlock.length) {
    gCTRBlock(bufBlock,BLOCK_SIZE,out,outOff);
    if (!forEncryption) {
      System.arraycopy(bufBlock,BLOCK_SIZE,bufBlock,0,macSize);
    }
    bufOff=bufBlock.length - BLOCK_SIZE;
    return BLOCK_SIZE;
  }
  return 0;
}
